apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-certificate
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: SC System and Communications Protection
    policy.open-cluster-management.io/controls: SC-8 Transmission Confidentiality and Integrity
    integrityshield.io/message: H4sIAAAAAAAAA5VUS2/bMAy++1cQ2W2osgzFgMK3Nh2GHjYUTbHL0ANj0Y1WPQxJzhIM+++jZDtx26QPnWyJ/Pjx4wMb9ZN8UM6W0Ditqu3UNWRFpdsQyQuDFu/JkI1T5T6tPxcPysoSrrNpYSiixIhlAWDR0IAhKvJR1arCSPyE1rqIkYOEZAlviBQiWolehhJ+XC1uYXENZ7OZ+HL6Rv8U+d55RQywmMNiyzaGiUiYO2Nam6glPnDtXaQqfb8V2dnonc644gxuPdpgVEgSMratlWRDhVrFbY53ZZmJ578iNFSl/D1jSZXjn+fIJShbO2/4TaqAS00scY06JPF6RZl+ozmpXkEBbvmbeV9SrazKIPk+HXxvTQfHrrbzfe26MsMHSPWEvR/QplEed6qlM+6F4RzrCUEb5HRoZzpIM3YMDVa0IM1ZOj9+BJaLc5EM/WsiqcZWx8ndIwPa7Awe2iWJj4/ejxaAM40reip5Zjd95gQqgFuT90pyyWG57Xw9VWxn76FBz1mw4LBG3RJwgCNI0xG3QAzJ3VKCdn9G94bLbFpz2Xayl3A6m60KIUTx7nL3I6xZ3nR7wb/M98AwL7sXcWCom8H7hurR9A+3h1yG/toFvmlzBzD/b961TclfTXiBexHa3PN5BMRLC2cXqltT/VD0UV7V6Jmqr/A6oGlO7cB2fEmfYQb6GLxLpBrtTAG8E2PLe2dy61ua9L0Rtw0Df8985PyJ6/kalU77ZA/7eKAMxmr1dcNNmxdYGMZMwN8H4h4ku1be2UT5BFgBbj525Z120jV16EZwPbn7V/wHn6ZcE0sGAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIVVdISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvQW5kREFDYlRWdVdJRERNVk1pdDhJcWNKdzJoV2J5VwpZMzBnam1EbTBsNi9kTjFQNENkZitpZGVRSy9qdzVZT1RERElGRGJ1T3NzRmx3Sk56Nk5nV1diY2NhL28wMFhjCkR2TCtoQ3Q1dTQ1LzhIamw2bm4weTRTa1VPcnZ4YVNzY3p0ZGxnYVoraWQ4cUhYU0xJeUJNdVdDcGtjc2U1dWIKMXlmUDVmc3RTUDhVOXFCcER2UHhsaTI4bFIxRG56YkdqQW5mdC9rV2E5Z0hwSDFyRm5DSE5hRWhmaFpkMWE5ZwpxM2tOR25qYmE2YndVYU9wQmdiM3dsdnFFdHNaZHRkQmhLam85eHlCWUZKU3YvZHlzWDdldDJqYnhCRGxwWFlzCm4rbGlkMnhaUHg5dHRTQ1RxRVA1Z2dVRzhwTWFQUEd6MURDQWEwYmE3WEFxOEh6MWlTZFBsTjNFcVA0TFN0SDEKZ0NoamNjV1lrdkxieFh1R3FQTm5SclhEMmZyc2VNZGh6TzMzWjZKNlluVWFHcGtNRjdOYThmcWwzeGVocEw3dAo5NzdnV05RelF2R2hkeXhBWWtRQ3hpRnc2WnpCWVk2VzNzU1FUL04xOElMano4SUdHYkNVdXo4b0NoemIrQVkwCkpTWCtlMnpzZ2RZaDg3aEdYS1dDZEVjTEJSOUJ1L0hJRlFTTFNaYz0KPVV0SWEKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: CertificatePolicy # cert management expiration
        metadata:
          name: policy-certificate-example
        spec:
          namespaceSelector:
            include: ["default"]
            exclude: ["kube-*"]
          remediationAction: inform # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          minimumDuration: 300h
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-certificate
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VUS2/bMAy++1cQ2W2osgzFgMK3Nh2GHjYUTbHL0ANj0Y1WPQxJzhIM+++jZDtx26QPnWyJ/Pjx4wMb9ZN8UM6W0Ditqu3UNWRFpdsQyQuDFu/JkI1T5T6tPxcPysoSrrNpYSiixIhlAWDR0IAhKvJR1arCSPyE1rqIkYOEZAlviBQiWolehhJ+XC1uYXENZ7OZ+HL6Rv8U+d55RQywmMNiyzaGiUiYO2Nam6glPnDtXaQqfb8V2dnonc644gxuPdpgVEgSMratlWRDhVrFbY53ZZmJ578iNFSl/D1jSZXjn+fIJShbO2/4TaqAS00scY06JPF6RZl+ozmpXkEBbvmbeV9SrazKIPk+HXxvTQfHrrbzfe26MsMHSPWEvR/QplEed6qlM+6F4RzrCUEb5HRoZzpIM3YMDVa0IM1ZOj9+BJaLc5EM/WsiqcZWx8ndIwPa7Awe2iWJj4/ejxaAM40reip5Zjd95gQqgFuT90pyyWG57Xw9VWxn76FBz1mw4LBG3RJwgCNI0xG3QAzJ3VKCdn9G94bLbFpz2Xayl3A6m60KIUTx7nL3I6xZ3nR7wb/M98AwL7sXcWCom8H7hurR9A+3h1yG/toFvmlzBzD/b961TclfTXiBexHa3PN5BMRLC2cXqltT/VD0UV7V6Jmqr/A6oGlO7cB2fEmfYQb6GLxLpBrtTAG8E2PLe2dy61ua9L0Rtw0Df8985PyJ6/kalU77ZA/7eKAMxmr1dcNNmxdYGMZMwN8H4h4ku1be2UT5BFgBbj525Z120jV16EZwPbn7V/wHn6ZcE0sGAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIVVdISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvQW5kREFDYlRWdVdJRERNVk1pdDhJcWNKdzJoV2J5VwpZMzBnam1EbTBsNi9kTjFQNENkZitpZGVRSy9qdzVZT1RERElGRGJ1T3NzRmx3Sk56Nk5nV1diY2NhL28wMFhjCkR2TCtoQ3Q1dTQ1LzhIamw2bm4weTRTa1VPcnZ4YVNzY3p0ZGxnYVoraWQ4cUhYU0xJeUJNdVdDcGtjc2U1dWIKMXlmUDVmc3RTUDhVOXFCcER2UHhsaTI4bFIxRG56YkdqQW5mdC9rV2E5Z0hwSDFyRm5DSE5hRWhmaFpkMWE5ZwpxM2tOR25qYmE2YndVYU9wQmdiM3dsdnFFdHNaZHRkQmhLam85eHlCWUZKU3YvZHlzWDdldDJqYnhCRGxwWFlzCm4rbGlkMnhaUHg5dHRTQ1RxRVA1Z2dVRzhwTWFQUEd6MURDQWEwYmE3WEFxOEh6MWlTZFBsTjNFcVA0TFN0SDEKZ0NoamNjV1lrdkxieFh1R3FQTm5SclhEMmZyc2VNZGh6TzMzWjZKNlluVWFHcGtNRjdOYThmcWwzeGVocEw3dAo5NzdnV05RelF2R2hkeXhBWWtRQ3hpRnc2WnpCWVk2VzNzU1FUL04xOElMano4SUdHYkNVdXo4b0NoemIrQVkwCkpTWCtlMnpzZ2RZaDg3aEdYS1dDZEVjTEJSOUJ1L0hJRlFTTFNaYz0KPVV0SWEKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
placementRef:
  name: placement-policy-certificate
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-certificate
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-certificate
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VUS2/bMAy++1cQ2W2osgzFgMK3Nh2GHjYUTbHL0ANj0Y1WPQxJzhIM+++jZDtx26QPnWyJ/Pjx4wMb9ZN8UM6W0Ditqu3UNWRFpdsQyQuDFu/JkI1T5T6tPxcPysoSrrNpYSiixIhlAWDR0IAhKvJR1arCSPyE1rqIkYOEZAlviBQiWolehhJ+XC1uYXENZ7OZ+HL6Rv8U+d55RQywmMNiyzaGiUiYO2Nam6glPnDtXaQqfb8V2dnonc644gxuPdpgVEgSMratlWRDhVrFbY53ZZmJ578iNFSl/D1jSZXjn+fIJShbO2/4TaqAS00scY06JPF6RZl+ozmpXkEBbvmbeV9SrazKIPk+HXxvTQfHrrbzfe26MsMHSPWEvR/QplEed6qlM+6F4RzrCUEb5HRoZzpIM3YMDVa0IM1ZOj9+BJaLc5EM/WsiqcZWx8ndIwPa7Awe2iWJj4/ejxaAM40reip5Zjd95gQqgFuT90pyyWG57Xw9VWxn76FBz1mw4LBG3RJwgCNI0xG3QAzJ3VKCdn9G94bLbFpz2Xayl3A6m60KIUTx7nL3I6xZ3nR7wb/M98AwL7sXcWCom8H7hurR9A+3h1yG/toFvmlzBzD/b961TclfTXiBexHa3PN5BMRLC2cXqltT/VD0UV7V6Jmqr/A6oGlO7cB2fEmfYQb6GLxLpBrtTAG8E2PLe2dy61ua9L0Rtw0Df8985PyJ6/kalU77ZA/7eKAMxmr1dcNNmxdYGMZMwN8H4h4ku1be2UT5BFgBbj525Z120jV16EZwPbn7V/wHn6ZcE0sGAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIVVdISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvQW5kREFDYlRWdVdJRERNVk1pdDhJcWNKdzJoV2J5VwpZMzBnam1EbTBsNi9kTjFQNENkZitpZGVRSy9qdzVZT1RERElGRGJ1T3NzRmx3Sk56Nk5nV1diY2NhL28wMFhjCkR2TCtoQ3Q1dTQ1LzhIamw2bm4weTRTa1VPcnZ4YVNzY3p0ZGxnYVoraWQ4cUhYU0xJeUJNdVdDcGtjc2U1dWIKMXlmUDVmc3RTUDhVOXFCcER2UHhsaTI4bFIxRG56YkdqQW5mdC9rV2E5Z0hwSDFyRm5DSE5hRWhmaFpkMWE5ZwpxM2tOR25qYmE2YndVYU9wQmdiM3dsdnFFdHNaZHRkQmhLam85eHlCWUZKU3YvZHlzWDdldDJqYnhCRGxwWFlzCm4rbGlkMnhaUHg5dHRTQ1RxRVA1Z2dVRzhwTWFQUEd6MURDQWEwYmE3WEFxOEh6MWlTZFBsTjNFcVA0TFN0SDEKZ0NoamNjV1lrdkxieFh1R3FQTm5SclhEMmZyc2VNZGh6TzMzWjZKNlluVWFHcGtNRjdOYThmcWwzeGVocEw3dAo5NzdnV05RelF2R2hkeXhBWWtRQ3hpRnc2WnpCWVk2VzNzU1FUL04xOElMano4SUdHYkNVdXo4b0NoemIrQVkwCkpTWCtlMnpzZ2RZaDg3aEdYS1dDZEVjTEJSOUJ1L0hJRlFTTFNaYz0KPVV0SWEKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
