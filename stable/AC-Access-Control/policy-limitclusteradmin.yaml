apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-limitclusteradmin
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: AC Access Control
    policy.open-cluster-management.io/controls: AC-3 Access Enforcement
    integrityshield.io/message: H4sIAAAAAAAAA5VUTW/bMAy9+1cQ3q2Isg5FgcG3LCuGHDYUSbfL0ANjMYkWWzIk2Ugw7L+Plj/qpEmT+mRb5KPeeySxUL/IOmV0AoXJVLofm4K0SLPSebIiR41rykn7sTIfq0/RVmmZwGMIjXLyKNFjEgFozKnDEJnKlW8xUOZKcwBqbTx6LuXqeLiinvOoJVrpEvgxWzzB4hE+396K+7sr81P0tDZWEQNMpjBJU3IOpkZ7a7JrMZrogCDuOowHvTI2DUGRKyitGVn+lCownKQ+SKrqsJzPpHK4zIilW2HmKOoqC095kfE1W00EmOUfSv1XWimtAkj4Xz/4Xq+6xMazGeaNbfABgj8wNIgpElskmUVhrIdKmSxQ6VGGZnfP26YL2iGzoz6hU6r/poqs8vsEauXK/AjZFZjSgjLWw9hhHrCwXEhy7d/xTfx8cES7/mhbLkncxCOIa6HcRq28OAw/6xmL5Dd07FJgMH6VBMqBYSpWSUkalvsm11LKcXoNBVqmw7JAhVlJwAXOII0Hd8txN23UnLM5X9hExvrpuAUSuI+EENG7O6Kd3gyb1m0xT8zxsjkRZ+e56DDmtBqMf/f3fGLXjv0l5mXoEObyzZqySPitcG/wiFwZRiRMjLi8d/qCzc5qJ6mtdVG1VzpfuN0JlQPBE6vyslbdvLQ/eXFJNVigAnhB+pLbIX6yJcVt7/h9wfDfw63k9Ch1UqHK6lX0Ans4YTn6dPOw4+Z17qVUXezvlnhSSVfKGl1ffASsg8U6FWZ61DS3qwdPUhU//4v+A+doFi1eBgAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIY1dISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvRWlYREFDMXFNN3pVNzhjdEdRNTRNMFE1MGhEdUJxbwpWaEcweW9LY1d4Y0VycExIMmN6ODE1eVZyNmZad0VaN2UvMTdEWG1OUUdySzU4ZFQzT09SNDUySnArb0IzWmhsCjVBc0VXeHpiZWY2eVBhUTI2NngwUzNQMjFjWlRwenYzUEJGSEN1WlMxbVFXT2xIdUlBVUxPeU1hWE1iQ1k0bVgKc0NibW5jeVpKSEx0VWRabTJRZ3RMbDRxZ0NqeEZTY1NFM0d3RGNIR0RDbkZzOENPMGhsNE5nR0gvY1pKbFhqUQpZOWs3aG9PM0FkdzRVamUyNER1VWdSU2FDY1hkVkZ4U2szc2QwTUZkL3BuY2ErdFo0N1JKVUhkRXhGcVlWUUxpCkxTMGgvM0g3UVdvVFdmb3FOajN2RkdLd0Eza2dPdDZxYjNPZmlJdm9qN3JGbFZQejdadFVpcHNCWlhDMHNLQUkKY3JZQUpmT2lyVFBBeENSM0tOcnJIRHIzWkJBaXdYREs4MW9Xc2V4dGRyZ1puS1A3M2FKZjJ3OWQxM2djTlkyZgp2Z0VRQkhvWXRkRUEzQVBTSm1GNlI3Vldrc1dmYWJXZGtKYTJiQ2c4UVJib0xVc0QvQkk1YUkza0h3aVRnVzhtCkF0cmZYVnJHV0d1S3M5K1AySVEyckJMZFBPWm1xKzNsZ1NkS2Vrcz0KPWRSSjMKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: IamPolicy # limit clusteradminrole and report violation
        metadata:
          name: policy-limitclusteradmin-example
        spec:
          severity: medium
          namespaceSelector:
            include: ["*"]
            exclude: ["kube-*", "openshift-*"]
          remediationAction: inform # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          maxClusterRoleBindingUsers: 5
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-limitclusteradmin
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VUTW/bMAy9+1cQ3q2Isg5FgcG3LCuGHDYUSbfL0ANjMYkWWzIk2Ugw7L+Plj/qpEmT+mRb5KPeeySxUL/IOmV0AoXJVLofm4K0SLPSebIiR41rykn7sTIfq0/RVmmZwGMIjXLyKNFjEgFozKnDEJnKlW8xUOZKcwBqbTx6LuXqeLiinvOoJVrpEvgxWzzB4hE+396K+7sr81P0tDZWEQNMpjBJU3IOpkZ7a7JrMZrogCDuOowHvTI2DUGRKyitGVn+lCownKQ+SKrqsJzPpHK4zIilW2HmKOoqC095kfE1W00EmOUfSv1XWimtAkj4Xz/4Xq+6xMazGeaNbfABgj8wNIgpElskmUVhrIdKmSxQ6VGGZnfP26YL2iGzoz6hU6r/poqs8vsEauXK/AjZFZjSgjLWw9hhHrCwXEhy7d/xTfx8cES7/mhbLkncxCOIa6HcRq28OAw/6xmL5Dd07FJgMH6VBMqBYSpWSUkalvsm11LKcXoNBVqmw7JAhVlJwAXOII0Hd8txN23UnLM5X9hExvrpuAUSuI+EENG7O6Kd3gyb1m0xT8zxsjkRZ+e56DDmtBqMf/f3fGLXjv0l5mXoEObyzZqySPitcG/wiFwZRiRMjLi8d/qCzc5qJ6mtdVG1VzpfuN0JlQPBE6vyslbdvLQ/eXFJNVigAnhB+pLbIX6yJcVt7/h9wfDfw63k9Ch1UqHK6lX0Ans4YTn6dPOw4+Z17qVUXezvlnhSSVfKGl1ffASsg8U6FWZ61DS3qwdPUhU//4v+A+doFi1eBgAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIY1dISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvRWlYREFDMXFNN3pVNzhjdEdRNTRNMFE1MGhEdUJxbwpWaEcweW9LY1d4Y0VycExIMmN6ODE1eVZyNmZad0VaN2UvMTdEWG1OUUdySzU4ZFQzT09SNDUySnArb0IzWmhsCjVBc0VXeHpiZWY2eVBhUTI2NngwUzNQMjFjWlRwenYzUEJGSEN1WlMxbVFXT2xIdUlBVUxPeU1hWE1iQ1k0bVgKc0NibW5jeVpKSEx0VWRabTJRZ3RMbDRxZ0NqeEZTY1NFM0d3RGNIR0RDbkZzOENPMGhsNE5nR0gvY1pKbFhqUQpZOWs3aG9PM0FkdzRVamUyNER1VWdSU2FDY1hkVkZ4U2szc2QwTUZkL3BuY2ErdFo0N1JKVUhkRXhGcVlWUUxpCkxTMGgvM0g3UVdvVFdmb3FOajN2RkdLd0Eza2dPdDZxYjNPZmlJdm9qN3JGbFZQejdadFVpcHNCWlhDMHNLQUkKY3JZQUpmT2lyVFBBeENSM0tOcnJIRHIzWkJBaXdYREs4MW9Xc2V4dGRyZ1puS1A3M2FKZjJ3OWQxM2djTlkyZgp2Z0VRQkhvWXRkRUEzQVBTSm1GNlI3Vldrc1dmYWJXZGtKYTJiQ2c4UVJib0xVc0QvQkk1YUkza0h3aVRnVzhtCkF0cmZYVnJHV0d1S3M5K1AySVEyckJMZFBPWm1xKzNsZ1NkS2Vrcz0KPWRSSjMKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
placementRef:
  name: placement-policy-limitclusteradmin
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-limitclusteradmin
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-limitclusteradmin
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VUTW/bMAy9+1cQ3q2Isg5FgcG3LCuGHDYUSbfL0ANjMYkWWzIk2Ugw7L+Plj/qpEmT+mRb5KPeeySxUL/IOmV0AoXJVLofm4K0SLPSebIiR41rykn7sTIfq0/RVmmZwGMIjXLyKNFjEgFozKnDEJnKlW8xUOZKcwBqbTx6LuXqeLiinvOoJVrpEvgxWzzB4hE+396K+7sr81P0tDZWEQNMpjBJU3IOpkZ7a7JrMZrogCDuOowHvTI2DUGRKyitGVn+lCownKQ+SKrqsJzPpHK4zIilW2HmKOoqC095kfE1W00EmOUfSv1XWimtAkj4Xz/4Xq+6xMazGeaNbfABgj8wNIgpElskmUVhrIdKmSxQ6VGGZnfP26YL2iGzoz6hU6r/poqs8vsEauXK/AjZFZjSgjLWw9hhHrCwXEhy7d/xTfx8cES7/mhbLkncxCOIa6HcRq28OAw/6xmL5Dd07FJgMH6VBMqBYSpWSUkalvsm11LKcXoNBVqmw7JAhVlJwAXOII0Hd8txN23UnLM5X9hExvrpuAUSuI+EENG7O6Kd3gyb1m0xT8zxsjkRZ+e56DDmtBqMf/f3fGLXjv0l5mXoEObyzZqySPitcG/wiFwZRiRMjLi8d/qCzc5qJ6mtdVG1VzpfuN0JlQPBE6vyslbdvLQ/eXFJNVigAnhB+pLbIX6yJcVt7/h9wfDfw63k9Ch1UqHK6lX0Ans4YTn6dPOw4+Z17qVUXezvlnhSSVfKGl1ffASsg8U6FWZ61DS3qwdPUhU//4v+A+doFi1eBgAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEtCQUFCQ2dBMEZpRUVDOFZXV2MvQlNhOXE3cENPcCtvcnBLeFFhdndGQW1BL1NIY1dISE5wWjI1bGNrQmwKYm5SbGNuQnlhWE5sTG1OdmJRQUtDUkNuNml1a3JGQnEvRWlYREFDMXFNN3pVNzhjdEdRNTRNMFE1MGhEdUJxbwpWaEcweW9LY1d4Y0VycExIMmN6ODE1eVZyNmZad0VaN2UvMTdEWG1OUUdySzU4ZFQzT09SNDUySnArb0IzWmhsCjVBc0VXeHpiZWY2eVBhUTI2NngwUzNQMjFjWlRwenYzUEJGSEN1WlMxbVFXT2xIdUlBVUxPeU1hWE1iQ1k0bVgKc0NibW5jeVpKSEx0VWRabTJRZ3RMbDRxZ0NqeEZTY1NFM0d3RGNIR0RDbkZzOENPMGhsNE5nR0gvY1pKbFhqUQpZOWs3aG9PM0FkdzRVamUyNER1VWdSU2FDY1hkVkZ4U2szc2QwTUZkL3BuY2ErdFo0N1JKVUhkRXhGcVlWUUxpCkxTMGgvM0g3UVdvVFdmb3FOajN2RkdLd0Eza2dPdDZxYjNPZmlJdm9qN3JGbFZQejdadFVpcHNCWlhDMHNLQUkKY3JZQUpmT2lyVFBBeENSM0tOcnJIRHIzWkJBaXdYREs4MW9Xc2V4dGRyZ1puS1A3M2FKZjJ3OWQxM2djTlkyZgp2Z0VRQkhvWXRkRUEzQVBTSm1GNlI3Vldrc1dmYWJXZGtKYTJiQ2c4UVJib0xVc0QvQkk1YUkza0h3aVRnVzhtCkF0cmZYVnJHV0d1S3M5K1AySVEyckJMZFBPWm1xKzNsZ1NkS2Vrcz0KPWRSSjMKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
